groups:
  - name: nginx-alerts
    rules:
      # 1ï¸âƒ£ HTTP 500 ì˜¤ë¥˜ ê¸‰ì¦ ê°ì§€
      - alert: HighHTTP500Errors
        expr: increase(nginx_http_responses_total{code="500"}[5m]) > 100
        for: 2m
        labels:
          severity: critical
        annotations:
          summary: "ğŸš¨ HTTP 500 Errors Detected!"
          description: "ìµœê·¼ 5ë¶„ ë™ì•ˆ 500 ì˜¤ë¥˜ê°€ 100íšŒ ì´ìƒ ë°œìƒí–ˆìŠµë‹ˆë‹¤."

      # 2ï¸âƒ£ ìš”ì²­ ì²˜ë¦¬ ì‹œê°„ì´ 2ì´ˆ ì´ìƒ ì´ˆê³¼
      - alert: HighRequestLatency
        expr: avg(nginx_http_requests_duration_seconds) > 2
        for: 3m
        labels:
          severity: warning
        annotations:
          summary: "â³ High Request Latency"
          description: "ìš”ì²­ ì²˜ë¦¬ ì‹œê°„ì´ í‰ê·  2ì´ˆ ì´ìƒ ê±¸ë¦¬ê³  ìˆìŠµë‹ˆë‹¤."

      # 3ï¸âƒ£ Nginx í™œì„± ì—°ê²° ê¸‰ì¦ (íŠ¸ë˜í”½ í­ì£¼ ê°ì§€)
      - alert: HighActiveConnections
        expr: nginx_connections_active > 1000
        for: 1m
        labels:
          severity: warning
        annotations:
          summary: "ğŸŒ High Active Connections"
          description: "í˜„ì¬ í™œì„±í™”ëœ ì—°ê²° ìˆ˜ê°€ 1000ê°œ ì´ìƒì…ë‹ˆë‹¤."

      # 4ï¸âƒ£ ëŒ€ê¸° ì—°ê²° ìˆ˜ ê³¼ë‹¤ (ì„œë²„ ê³¼ë¶€í•˜ ìœ„í—˜)
      - alert: HighWaitingConnections
        expr: nginx_connections_waiting > 500
        for: 2m
        labels:
          severity: critical
        annotations:
          summary: "ğŸš¦ High Waiting Connections"
          description: "ëŒ€ê¸° ì¤‘ì¸ ì—°ê²° ìˆ˜ê°€ 500ê°œë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤."

      # 5ï¸âƒ£ HTTP ìš”ì²­ ìˆ˜ ê¸‰ê²©í•œ ê°ì†Œ (ì„œë¹„ìŠ¤ ì¥ì•  ê°ì§€)
      - alert: RequestDropDetected
        expr: rate(nginx_http_requests_total[5m]) < 10
        for: 3m
        labels:
          severity: critical
        annotations:
          summary: "âŒ Request Drop Detected"
          description: "HTTP ìš”ì²­ ìˆ˜ê°€ ë¹„ì •ìƒì ìœ¼ë¡œ ê°ì†Œí–ˆìŠµë‹ˆë‹¤."
